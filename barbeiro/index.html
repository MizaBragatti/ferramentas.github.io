<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Servi√ßos - Barbearia</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Verifica√ß√£o de Login e Permiss√£o -->
    <script>
        // Verificar se est√° logado
        const barbeiroLogado = sessionStorage.getItem('barbeiroLogado');
        const nomeBarbeiro = sessionStorage.getItem('nomeBareiro');
        if (!barbeiroLogado) {
            window.location.href = 'login.html';
        }
        // Expor vari√°veis para uso no script.js
        window.BARBEIRO_LOGADO = barbeiroLogado;
        window.NOME_BARBEIRO = nomeBarbeiro;
        // Exibir bot√µes de barbeiro conforme usu√°rio logado
        document.addEventListener('DOMContentLoaded', function() {
            if (window.BARBEIRO_LOGADO == '1') {
                // S√©rgio v√™ ambos
                document.getElementById('btnBarbeiro1').style.display = '';
                document.getElementById('btnBarbeiro2').style.display = '';
                document.getElementById('btnRelatorioBarbeiro').style.display = '';
                document.getElementById('btnHistoricoMensal').style.display = '';
            } else if (window.BARBEIRO_LOGADO == '2') {
                // H√©lio s√≥ v√™ ele mesmo
                document.getElementById('btnBarbeiro1').style.display = 'none';
                document.getElementById('btnBarbeiro2').style.display = '';
                document.getElementById('btnRelatorioBarbeiro').style.display = 'none';
                document.getElementById('btnHistoricoMensal').style.display = 'none';
            }
        });
    </script>

    <div class="container">
        <header>
            <div class="header-top">
                <div>
                    <h1>ü™í Controle de Servi√ßos</h1>
                    <div class="data-atual" id="dataAtual"></div>
                </div>
                <button class="btn-sair" onclick="sair()" title="Sair">
                    üö™ Sair
                </button>
            </div>
            <div class="usuario-logado" id="usuarioLogado"></div>
            <div class="status-conexao" id="statusConexao">
                <span class="status-indicator"></span>
                <span class="status-text">Conectando...</span>
            </div>
        </header>

        <!-- Sele√ß√£o de Barbeiro -->
        <div class="selecao-barbeiro">
            <h2>Selecione o Barbeiro</h2>
            <div class="barbeiros-grid">
                <button class="barbeiro-btn" id="btnBarbeiro1" onclick="selecionarBarbeiro(1)" style="display:none;">
                    <img src="img/Sergio-Barbeiro.png" alt="S√©rgio" class="barbeiro-foto">
                    <span class="barbeiro-nome">S√©rgio</span>
                    <span class="barbeiro-total" id="totalBarbeiro1">0 servi√ßos</span>
                </button>
                <button class="barbeiro-btn" id="btnBarbeiro2" onclick="selecionarBarbeiro(2)" style="display:none;">
                    <span class="barbeiro-icon">üë®‚Äçü¶±</span>
                    <span class="barbeiro-nome">H√©lio</span>
                    <span class="barbeiro-total" id="totalBarbeiro2">0 servi√ßos</span>
                </button>
            </div>
        </div>

        <div class="resumo-dia">
            <h2>Resumo do Dia</h2>
            <div class="total-servicos">
                <span class="label">Total Geral:</span>
                <span class="valor" id="totalServicos">0</span>
            </div>
        </div>

        <div class="servicos-grid" id="servicosGrid">
            <!-- Servi√ßos ser√£o inseridos aqui pelo JavaScript -->
        </div>

        <div class="historico">
            <h3>√öltimos Registros</h3>
            <div class="historico-lista" id="historicoLista">
                <!-- Hist√≥rico ser√° inserido aqui -->
            </div>
        </div>

        <div class="acoes-admin">
            <button class="btn-relatorio" onclick="abrirRelatorio()">üìä Ver Relat√≥rio Completo</button>
            <button class="btn-relatorio-barbeiro" id="btnRelatorioBarbeiro" onclick="abrirRelatorioPorBarbeiro()" style="display:none;">üë• Relat√≥rio por Barbeiro</button>
            <button class="btn-relatorio-barbeiro" id="btnHistoricoMensal" onclick="window.location.href='historico-mensal.html'" style="display:none;">üìÖ Hist√≥rico Mensal</button>
        </div>
    </div>

    <!-- Modal de Exclus√£o de Servi√ßo -->
    <div class="modal" id="modalExclusao">
        <div class="modal-content">
            <h3>Remover Servi√ßo</h3>
            <p>Deseja realmente remover este servi√ßo?</p>
            <p style="font-weight: bold; color: var(--dourado); margin-top: 10px;" id="servicoExcluir"></p>
            <div class="modal-acoes">
                <button class="btn-cancelar" onclick="fecharModal()">Cancelar</button>
                <button class="btn-confirmar" onclick="excluirServico()">Remover</button>
            </div>
        </div>
    </div>

    <!-- Modal de Relat√≥rio -->
    <div class="modal" id="modalRelatorio">
        <div class="modal-content modal-relatorio">
            <h3>üìä Relat√≥rio Completo</h3>
            <div class="relatorio-conteudo" id="relatorioConteudo">
                <!-- Relat√≥rio ser√° inserido aqui -->
            </div>
            <button class="btn-fechar" onclick="fecharRelatorio()">Fechar</button>
        </div>
    </div>

    <!-- Modal de Relat√≥rio por Barbeiro -->
    <div class="modal" id="modalRelatorioBarbeiro">
        <div class="modal-content modal-relatorio">
            <h3>üë• Relat√≥rio por Barbeiro</h3>
            <div class="relatorio-conteudo" id="relatorioConteudoBarbeiro">
                <!-- Relat√≥rio por barbeiro ser√° inserido aqui -->
            </div>
            <button class="btn-fechar" onclick="fecharRelatorioBarbeiro()">Fechar</button>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <script src="script.js"></script>
</body>
</html>
