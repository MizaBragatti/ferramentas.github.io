<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Servi莽os - Barbearia</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Verifica莽茫o de Login e Permiss茫o -->
    <script>
        // Verificar se est谩 logado
        const barbeiroLogado = sessionStorage.getItem('barbeiroLogado');
        const nomeBarbeiro = sessionStorage.getItem('nomeBareiro');
        if (!barbeiroLogado) {
            window.location.href = 'login.html';
        }
        // Expor vari谩veis para uso no script.js
        window.BARBEIRO_LOGADO = barbeiroLogado;
        window.NOME_BARBEIRO = nomeBarbeiro;
        // Auto-selecionar o barbeiro logado
        document.addEventListener('DOMContentLoaded', function() {
            // Pr茅-selecionar o barbeiro automaticamente
            const barbeiro = parseInt(window.BARBEIRO_LOGADO);
            if (typeof selecionarBarbeiro === 'function') {
                setTimeout(() => {
                    selecionarBarbeiro(barbeiro);
                }, 100);
            }
            
            // Configurar visibilidade dos bot玫es de relat贸rio
            if (window.BARBEIRO_LOGADO == '1') {
                // S茅rgio v锚 ambos relat贸rios
                document.getElementById('btnRelatorioBarbeiro').style.display = '';
                document.getElementById('btnHistoricoMensal').style.display = '';
            } else if (window.BARBEIRO_LOGADO == '2') {
                // H茅lio n茫o v锚 relat贸rios administrativos
                document.getElementById('btnRelatorioBarbeiro').style.display = 'none';
                document.getElementById('btnHistoricoMensal').style.display = 'none';
            }
        });
    </script>

    <div class="container">
        <header>
            <div class="header-top">
                <div>
                    <h1> Controle de Servi莽os</h1>
                    <div class="data-atual" id="dataAtual"></div>
                </div>
                <button class="btn-sair" onclick="sair()" title="Sair">
                     Sair
                </button>
            </div>
            <div class="usuario-logado" id="usuarioLogado"></div>
            <div class="status-conexao" id="statusConexao">
                <span class="status-indicator"></span>
                <span class="status-text">Conectando...</span>
            </div>
        </header>

        <div class="resumo-dia">
            <h2>Resumo do Dia</h2>
            <div class="total-servicos">
                <span class="label">Total Geral:</span>
                <span class="valor" id="totalServicos">0</span>
            </div>
        </div>

        <div class="servicos-grid" id="servicosGrid">
            <!-- Servi莽os ser茫o inseridos aqui pelo JavaScript -->
        </div>

        <div class="historico">
            <h3>ltimos Registros</h3>
            <div class="historico-lista" id="historicoLista">
                <!-- Hist贸rico ser谩 inserido aqui -->
            </div>
        </div>

        <div class="acoes-admin">
            <button class="btn-relatorio" onclick="abrirRelatorio()"> Ver Relat贸rio Completo</button>
            <button class="btn-relatorio-barbeiro" id="btnRelatorioBarbeiro" onclick="abrirRelatorioPorBarbeiro()" style="display:none;"> Relat贸rio por Barbeiro</button>
            <button class="btn-relatorio-barbeiro" id="btnHistoricoMensal" onclick="window.location.href='historico-mensal.html'" style="display:none;"> Hist贸rico Mensal</button>
        </div>
    </div>

    <!-- Modal de Exclus茫o de Servi莽o -->
    <div class="modal" id="modalExclusao">
        <div class="modal-content">
            <h3>Remover Servi莽o</h3>
            <p>Deseja realmente remover este servi莽o?</p>
            <p style="font-weight: bold; color: var(--dourado); margin-top: 10px;" id="servicoExcluir"></p>
            <div class="modal-acoes">
                <button class="btn-cancelar" onclick="fecharModal()">Cancelar</button>
                <button class="btn-confirmar" onclick="excluirServico()">Remover</button>
            </div>
        </div>
    </div>

    <!-- Modal de Relat贸rio -->
    <div class="modal" id="modalRelatorio">
        <div class="modal-content modal-relatorio">
            <h3> Relat贸rio Completo</h3>
            <div class="relatorio-conteudo" id="relatorioConteudo">
                <!-- Relat贸rio ser谩 inserido aqui -->
            </div>
            <button class="btn-fechar" onclick="fecharRelatorio()">Fechar</button>
        </div>
    </div>

    <!-- Modal de Relat贸rio por Barbeiro -->
    <div class="modal" id="modalRelatorioBarbeiro">
        <div class="modal-content modal-relatorio">
            <h3> Relat贸rio por Barbeiro</h3>
            <div class="relatorio-conteudo" id="relatorioConteudoBarbeiro">
                <!-- Relat贸rio por barbeiro ser谩 inserido aqui -->
            </div>
            <button class="btn-fechar" onclick="fecharRelatorioBarbeiro()">Fechar</button>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <script src="script.js"></script>
</body>
</html>
